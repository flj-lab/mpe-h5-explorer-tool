# mpe-h5-explorer-tool
Enables users familiar with MATLAB style plotting to work with HDF5 datafiles generated by MTS Multipurpose Elite (MPE). 
## The Problem:
The nature of some of the high-cycle fatigue tests we were running meant MPE was unable to export raw data to `.csv` files, likely because the data is long enough to exceed the RAM limit on the machine when writting to `.csv`. Teammembers need to be able to export the data and generate our own custom plots, but are generally not familiar with most large-dataset formats.

## The Solution
MPE uses [Hierarchical Data Format 5](https://en.wikipedia.org/wiki/Hierarchical_Data_Format) (HDF5, file extension `.h5`) to save data internally, HDF5 files are a lot smaller and quicker to work with than the more human-readable `.csv` files. The `mpe-exporter` tool is intended to help lab members produce useful data visualizations in a way that is fairly similar to what they're used to in MATLAB. It uses `h5py` and `numpy` to interact with the HDF5 data files, assuming they are formatted in the manner typical of MPE datasets. The tools are designed to extract relevant information from `.h5` files and expose it to the user, without them having to worry about the particulars of HDF5 data. See [`example_main.py`](./example_main.py) for an example of how to use the toolset.

# Download

## 1. Install Python
If you don't already have Python installed, you'll need to install it.
- **Windows**: Download the latest Python 3 installer from [python.org](https://www.python.org/downloads/windows/). **Important**: During installation, make sure to check the box that says "Add Python to PATH" and also ensure that "tcl/tk and IDLE" is selected (this is usually selected by default and is needed for graphical elements).
- **Linux**: Python 3 is often pre-installed. You can check by opening a terminal and typing `python3 --version`. If it's not installed, or you need a specific version, use your distribution's package manager. For example, on Debian/Ubuntu:
  ```bash
  sudo apt update
  sudo apt install python3 python3-pip python3-venv python3-tk
  ```
  For Fedora:
  ```bash
  sudo dnf install python3 python3-pip python3-tkinter
  ```

## 2. Download This Tool
You can download this tool in one of two ways:
*   **Option A: Download ZIP**
    1.  Go to the GitHub repository page.
    2.  Click the green "<> Code" button.
    3.  Select "Download ZIP".
    4.  Extract the downloaded ZIP file to a location of your choice.
*   **Option B: Clone with Git** (if you have Git installed)
    1.  Open a terminal or command prompt.
    2.  Navigate to the directory where you want to download the tool.
    3.  Run: 
    ```
    git clone https://github.com/flj-lab/mpe-h5-explorer-tool.git
    ```

    4.  This will create a folder named `mpe-h5-explorer-tool` with all the project files.
*   **Option C: Clone with GitHub Desktop**
    1.  If you don't have it, download and install GitHub Desktop.
    2.  Open GitHub Desktop.
    3.  Click on "File" > "Clone Repository...".
    4.  Go to the "URL" tab.
    5.  Enter the repository URL: `https://github.com/flj-lab/mpe-h5-explorer-tool.git`.
    6.  Choose a local path where you want to save the project.
    7.  Click "Clone".

## 3. Install Requirements
After downloading, navigate into the project's root directory (e.g., `mpe-h5-explorer-tool`) in your terminal or command prompt. Then, run the appropriate setup script for your operating system. This will create a Python virtual environment and install the necessary packages.

### For Windows Users:
1.  Open a Command Prompt (cmd.exe) or PowerShell.
2.  Navigate to the directory where you downloaded/extracted the tool (e.g., `cd path\to\mpe-h5-explorer-tool`).
3.  Run the setup script:
    ```batch
    setup_windows.bat
    ```

### For Linux Users:
1.  Open a terminal.
2.  Navigate to the directory where you downloaded/cloned the tool (e.g., `cd path/to/mpe-h5-explorer-tool`).
3.  Make the setup script executable: `chmod +x setup_linux.sh`
4.  Run the setup script: `./setup_linux.sh`

# Basic Usage

The `mpe-h5-explorer-tool` provides functions to inspect, combine, and extract data from HDF5 files generated by MTS Multipurpose Elite software. Here's a brief overview of a common workflow, as demonstrated in `example_main.py`:

1.  **Import the tool and other necessary libraries:**
    ```python
    import mpe_h5_explorer_tool as met
    import matplotlib.pyplot as plt
    ```

2.  **Define file paths:**
    Specify the paths to your input HDF5 files and where you want to save any output files (e.g., combined data, plots).
    ```python
    low_freq_cycles_path = 'path/to/your/low_freq_data.h5'
    high_freq_cycles_path = 'path/to/your/high_freq_data.h5'
    output_file_path = 'path/to/your/combined_sorted_data.h5'
    output_plot_path = 'path/to/your/plot.png'
    ```

3.  **(Optional) Check HDF5 file validity:**
    You can inspect the structure of your HDF5 files.
    ```python
    met.check_h5_file(low_freq_cycles_path, output_file="low_freq_h5_check.txt")
    ```

4.  **Combine and sort HDF5 files:**
    If you have data split across multiple files (e.g., high and low frequency DAQ), you can combine them into a single file, sorted by a common field like "Running Time".
    ```python
    met.combine_and_sort_h5_files([high_freq_cycles_path, low_freq_cycles_path], output_file_path)
    ```

5.  **Extract signal information and data for plotting:**
    Retrieve available signal names and units, then extract specific data columns for plotting.
    ```python
    signal_names, signal_units = met.extract_and_print_signal_info(output_file_path)
    print("Available signal names:", signal_names)

    x_data, y_data, x_label, y_label, title_str, x_unit, y_unit = met.get_h5_plot_stuff(
        output_file_path, 
        x_signal_name=b"Running Time", 
        y_signal_name=b"Axial Force"
    )
    ```

6.  **Plot the data:**
    Use a plotting library like `matplotlib` to visualize the extracted data.
    ```python
    if x_data is not None and y_data is not None:
        plt.figure(figsize=(12,6))
        plt.plot(x_data, y_data)
        plt.xlabel(x_label)
        plt.ylabel(y_label)
        plt.title(title_str)
        plt.grid(True)
        plt.tight_layout()
        plt.savefig(output_plot_path)
        print(f"Plot saved to: {output_plot_path}")
    ```

For a more detailed example, please refer to `example_main.py`.

